<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOXANIME - C√¥ng C·ª• Bot Giao D·ªãch ƒê·ªôc L·∫≠p (Unlimited Data)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp }
         from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, setPersistence, browserLocalPersistence, signOut }
         from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, collection, query, getDocs, serverTimestamp, writeBatch, increment, orderBy, limit }
         from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // C·∫§U H√åNH FIREBASE V√Ä BI·∫æN TO√ÄN C·ª§C
        const FIREBASE_DEFAULT_CONFIG = {"apiKey": "AIzaSyDvI4bfJXh08biyFORz6X2xwBc19TERWEc", "authDomain": "foxanime-e77d4.firebaseapp.com","projectId": "foxanime-e77d4", "storageBucket": "foxanime-e77d4.firebasestorage.app", "messagingSenderId": "1025177423292", "appId": "1:1025177423292:web:14c200fbc905e79b3c6fb9"};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfigFromCanvas = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null; 
        const finalConfig = firebaseConfigFromCanvas?.projectId ? firebaseConfigFromCanvas : FIREBASE_DEFAULT_CONFIG;

        let app, db, auth;
        let userId = null;
        let dataCollectionPath = `artifacts/${appId}/public/data/movies`;
        let globalMovieCache = [];
        let isAuthInitialised = false;
        let botInterval = null; 
        let isBotRunning = false;
        
        // --- H·ªÜ TH·ªêNG T·∫†O T√äN "V≈® TR·ª§ WIBU" (MASSIVE & MIXED) ---
        const getBotDisplayName = () => {
            const prefixes = [
                "Ch√∫a T·ªÉ", "√îng Tr√πm", "S√°t Th·ªß", "Th√°nh", "Gi√°o Ch·ªß", "Huy·ªÅn Tho·∫°i", "K·∫ª H·ªßy Di·ªát", "Ng∆∞·ªùi Ch∆°i H·ªá", 
                "Tr√πm Cu·ªëi", "Vua L√¨ ƒê√≤n", "Thanh Ni√™n", "Hot Boy", "Hot Girl", "Idol T√≥p T√≥p", "Ph√°p S∆∞", 
                "Chuy√™n Gia", "T√†i ƒê·∫°t", "Boy", "Girl", "M√®o B√©o", "ƒê·ªá T·ª≠", "V·ª£ C·ªßa", "Ch·ªìng C·ªßa", "Fan C·ª©ng",
                "ƒê·∫°i Ca", "Ti·ªÉu Mu·ªôi", "C√¥ng Ch√∫a", "Ho√†ng T·ª≠", "So√°i Ca", "Th·∫ßn ƒê·ªìng", "K·∫ª Lang Thang", 
                "T·ªôc Tr∆∞·ªüng", "Th·ªß Lƒ©nh", "Chi·∫øn Th·∫ßn", "Ma V∆∞∆°ng", "ƒê·∫°i ƒê·∫ø", "Ng∆∞·ªùi Qua ƒê∆∞·ªùng", "Th√°m T·ª≠",
                "Ti√™n T√¥n", "Y·∫øu Sinh L√Ω", "C·ª•c N·ª£", "Ch·ªß H·ªôi", "Th·∫ßn B√†i", "ƒê·∫°o T·∫∑c", "Chi·∫øn T∆∞·ªõng", "M·∫´u H·∫≠u",
                "Ho√†ng H·∫≠u", "Th·ªï D√¢n", "Thanh Long", "Ph∆∞·ª£ng Ho√†ng", "V√¥ Danh", "Ti·ªÉu T·ª≠", "L√£o ƒê·∫°i",
                "ƒê·ªôc C√¥", "Thi√™n H·∫°", "ƒê·ªá Nh·∫•t", "Minh Ch·ªß", "Ti·ªÉu Ca", "V√µ Th√°nh", "Si√™u C·∫•p", "B·∫≠c Th·∫ßy",
                "Ph∆∞·ª£t Th·ªß", "C√¢y Kh·∫ø", "Ng∆∞·ªùi Y√™u C≈©", "L·ªõp Tr∆∞·ªüng", "B√† Tr√πm", "K·∫ª Thao T√∫ng", "Ng√¥i Sao",
                "Anh Hai", "Ch·ªã ƒê·∫°i", "T·ªïng Bi√™n T·∫≠p", "Admin", "Mod", "Chi·∫øn L∆∞·ª£c", "Th·ª£ SƒÉn", "Ph√° ƒê·∫£o", 
                "ƒê·∫°o Sƒ©", "Thi·∫øu Gia", "Th·∫ø T·ª≠", "C·ª• T·ªï", "Th√°nh N·ªØ", "N·ªØ Th·∫ßn", "Nam Th·∫ßn", "B√° Ch·ªß", "H·ªçc B√°",
                "H·ªçc Tra", "K·∫ª Si T√¨nh", "Ng∆∞·ªùi √Çm Ph·ªß", "Th√°nh Ph·ªìng", "Vua Tr√≤ Ch∆°i", "Th√°nh Gi√≥ng", "Ho√†ng ƒê·∫ø",
                "T∆∞·ªõng Qu√¢n", "Hi·ªáp Sƒ©", "L√£ng Kh√°ch", "Ph·∫£n Di·ªán", "Nh√¢n V·∫≠t Ch√≠nh", "Ng∆∞·ªùi Qua ƒê∆∞·ªùng A",
                "B√©", "Nh√≥c", "C·∫≠u", "C√¥", "M·ª£", "D√¨", "Ch√∫", "B√°c", "√îng", "B√†", "Th√≠m", "Cu", "H·∫Øn", "Y",
                "K·∫ª", "Ng∆∞·ªùi", "Th·∫±ng", "Con", "ƒê·ª©a", "V·ªã", "B·∫≠c", "ƒê·∫•ng", "Ch√∫a", "Th·∫ßn", "Ma", "Qu·ª∑",
                "Si√™u Nh√¢n", "Ng∆∞·ªùi D∆°i", "Ng∆∞·ªùi Nh·ªán", "Th·ª£ S·ª≠a ·ªêng N∆∞·ªõc", "H·∫£i T·∫∑c", "Ninja", "Th·∫ßn Ch·∫øt"
            ];
            
            const nouns = [
                "Wibu", "Gacha", "Simp", "Meme", "Waifu", "Drama", "Spoil", "Net", "Wifi", "Deadline", 
                "Yasuo", "Flop", "N·ª£ M√¥n", "M√¨ T√¥m", "Tr√† S·ªØa", "B√°nh Tr√°ng", "Tiktok", "Facebook", "Discord", 
                "Youtube", "Anime", "Manga", "Hent...", "Tu Ti√™n", "Xuy√™n Kh√¥ng", "B√°ch Khoa", "Saitama", "Levi", 
                "Goku", "Naruto", "Luffy", "Zoro", "Kirito", "Asuna", "Rem", "ZeroTwo", "Makima", "Anya",
                "Husky", "Mochi", "Cosplay", "Fandom", "OTP", "Check Var", "Keo Ly", "M√£i M·∫≠n", "X√† L∆°", 
                "Overthinking", "T·∫•u H√†i", "Thao T√∫ng", "ƒê∆°n Ph∆∞∆°ng", "H·∫Øc √Åm", "V√¥ C·ª±c", "√Ånh S√°ng", "H·∫Øc H√≥a", 
                "S∆∞ Ph·ª•", "V·∫°n Ki·∫øm", "C·∫©m Nang", "L∆∞∆°ng Th√°ng", "Tr∆∞·ªüng Khoa", "ƒê·ªì √Ån", "T·∫•m Chi·∫øu", 
                "Ng√°o Ng∆°", "B√© Ba", "Ti·ªÉu Tam", "H·ªçc Sinh", "Gi√°o Vi√™n", "ƒê·∫ßu B·∫øp", "S√°t Th·ªß", "Ti·ªÅn T·ªá",
                "Th·ªß Kho", "T∆∞ B·∫£n", "ƒê·∫ø V∆∞∆°ng", "C·∫©u L∆∞∆°ng", "ƒê·ªôc Gi·∫£", "Kh√°n Gi·∫£", "Phim R√°c",
                "Trai Th·∫≥ng", "G√°i Xinh", "ƒê·∫ßu G·∫•u", "L√≤ Luy·ªán", "C√† Kh·ªãa", "C∆°m Tr√≥", "V∆∞∆°ng Gi·∫£", "ƒê·∫°i Th·∫ßn",
                "K·ª≥ L√¢n", "R·ªìng", "Ph∆∞·ª£ng", "Ng√¢n H√†", "V≈© Tr·ª•", "Qu·ªπ ƒê·∫°o", "B√£o", "S·∫•m S√©t", "Kim C∆∞∆°ng",
                "Ph·ªü", "B√≥ng ƒê√°", "Crypto", "C·ªông ƒê·ªìng", "Game", "L√¥ ƒê·ªÅ", "Ch·ª©ng Kho√°n", "√î T√¥", "M√°y Bay",
                "Nh√¢n V·∫≠t Ph·ª•", "ƒê·∫°o C·ª•", "M√†u S·∫Øc", "Ph·∫£n Di·ªán", "Ph√¢n T√≠ch", "ƒêam M√™", "H·∫£i Quay Xe",
                "D√¢n T·ªï", "Racing Boy", "Sadboy", "Goodboy", "Badboy", "Ch√∫a H·ªÅ", "Th√°nh M√µm", "Vua L∆∞·ªùi",
                "H·ªçc D·ªët", "Nh√† Gi√†u", "ƒê·∫°i Gia", "Thi·∫øu Gia", "Ti·ªÉu Th∆∞", "C√¥ng T·ª≠", "Th∆∞ Sinh", "S√°t G√°i",
                "FA", "·∫æ B·ªÅn V·ªØng", "S·ª£ V·ª£", "N·ªÉ V·ª£", "S·ª£ Ma", "Y·∫øu Tim", "M√™ G√°i", "M√™ Trai",
                "Eren", "Mikasa", "Armin", "Gojo", "Sukuna", "Itadori", "Megumi", "Nobara", "Tanjiro", "Nezuko",
                "Zenitsu", "Inosuke", "Rengoku", "Akaza", "Muzan", "Yuji", "Yuta", "Maki", "Panda", "Toge",
                "Denji", "Power", "Aki", "Makima", "Himeno", "Kobeni", "Reze", "Quanxi", "Kishibe", "Katana",
                "Boruto", "Sarada", "Mitsuki", "Kawaki", "Himawari", "Shikadai", "Inojin", "Chocho", "Sumire",
                "Asta", "Yuno", "Noelle", "Yami", "Luck", "Magna", "Finral", "Vanessa", "Charmy", "Grey",
                "Deku", "Bakugo", "Todoroki", "Uraraka", "Iida", "Tsuyu", "Kirishima", "Kaminari", "Jiro", "Momo",
                "Saitama", "Genos", "Tatsumaki", "Fubuki", "Bang", "King", "Sonic", "Garou", "Boros", "Orochi",
                "Kaneki", "Touka", "Rize", "Hide", "Tsukiyama", "Arima", "Amon", "Juuzou", "Eto", "Tatara",
                "Rimuru", "Veldora", "Shion", "Benimaru", "Shuna", "Souei", "Hakurou", "Gobta", "Ranga", "Milim",
                "Subaru", "Emilia", "Ram", "Beatrice", "Roswaal", "Puck", "Otto", "Garfiel", "Echidna",
                "Ainz", "Albedo", "Shalltear", "Cocytus", "Demiurge", "Aura", "Mare", "Sebas", "Pandora"
            ];
            
            const suffixes = [
                "Gaming", "TV", "Official", "Vlog", "V√≠p Pro", "No1", "99", "2k", "Chan", "Sama", "Kun", 
                "Senpai", "D·∫°o", "Ch√∫a", "Slayer", "Master", "Legend", "God", "King", "Fa", "C√¥ ƒê∆°n", 
                "L·∫°nh L√πng", "H√†i H∆∞·ªõc", "Vui T√≠nh", "Y√™u ƒê·ªùi", "Tr·∫ßm C·∫£m", "Suy", "Keo L·ª≥",
                "X·ªâu", "Xinh", "Xinh ƒê·∫πp", "Ngoan", "Nh√¢y", "B·ª±a", "Th·∫≥ng Th·∫Øn", "Nh·∫•t", "Nh√¨", "Tam", 
                "X·∫°o L...", "T·ªânh", "·ªú M√¢y Zing", "G√∫t Ch√≥p", "G·∫Øt", "Kh√©t", "Ch·∫•t", "Real", "Fake", 
                "Th√¢m Ni√™n", "H·ª•t H·∫´ng", "S·∫ßu", "Th√†nh C√¥ng", "Th·∫•t B·∫°i", "Ch√≠nh Hi·ªáu",
                "Tu·ªïi", "ƒê·ªùi", "Ngh√®o", "Gi√†u", "Qu√°", "M·ªõi", "C≈©", "ƒê·∫πp Trai", "Xinh G√°i", "H·∫øt",
                "Ch·ªù", "Th·ªü", "Lu√¥n", "ƒê·∫•y", "Nh√≥c", "T√≠", "M·∫≠p", "G·∫ßy", "T√°o B·∫°o", "Th·∫ßn Tho·∫°i",
                "Huy·ªÅn ·∫¢o", "M·ªông M∆°", "ƒê·∫≥ng C·∫•p", "B√¨nh D√¢n", "Ph√° S·∫£n", "Th·∫ßn T√†i", "D≈©ng C·∫£m", "G√≥c Ph·ªë",
                "Online", "Mobile", "PC", "Console", "Max Ping", "Lag", "Disconnect", "AFK", "Feed", "Carry",
                "Tanker", "Support", "Mid", "Top", "Ad", "R·ª´ng", "Gank", "Farm", "Ks",
                "Solo", "Squad", "Team", "Clan", "Guild", "Party", "Room", "Lobby", "Rank", "Bot",
                "Hack", "Cheat", "Mod", "Bug", "Glitch", "Lag", "Ping", "FPS", "Drop", "Crash",
                "Win", "Lose", "Draw", "GG", "WP", "EZ", "Noob", "Pro", "Hacker", "Cheater",
                "S1", "S2", "S3", "V1", "V2", "V3", "X", "Y", "Z", "Alpha", "Beta", "Omega"
            ];

            // T√™n ng∆∞·ªùi Vi·ªát b√¨nh th∆∞·ªùng (M·ªü r·ªông th√™m)
            const normalNames = [
                "H·∫£i", "My", "Tu·∫•n", "Linh", "H√πng", "Trang", "Nam", "Huy·ªÅn", "Long", "Nga", "ƒê·∫°t", "V√¢n",
                "T√¢m", "Th·∫£o", "H∆∞∆°ng", "Lan", "Mai", "C√∫c", "Tr√∫c", "ƒê√†o", "M·∫≠n", "L√™", "T√°o", "·ªîi"
            ];

            const type = Math.random();
            let name;
            
            if (type < 0.3) { 
                // 30% T√™n Th∆∞·ªùng + H·∫≠u T·ªë
                const baseName = normalNames[Math.floor(Math.random() * normalNames.length)];
                const firstName = baseName.split(" ").pop(); 
                const cleanName = firstName.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/ƒë/g, 'd').replace(/ƒê/g, 'D');
                const suffix = suffixes[Math.floor(Math.random() * suffixes.length)];
                
                if (Math.random() < 0.5) {
                     name = cleanName + suffix.toLowerCase(); 
                } else {
                     name = `${cleanName} ${suffix}`; 
                }

            } else if (type < 0.5) { 
                 // 20% Danh hi·ªáu + Danh t·ª´
                name = `${prefixes[Math.floor(Math.random() * prefixes.length)]} ${nouns[Math.floor(Math.random() * nouns.length)]}`;
            } else if (type < 0.8) {
                 // 30% Danh t·ª´ + H·∫≠u t·ªë
                name = `${nouns[Math.floor(Math.random() * nouns.length)]} ${suffixes[Math.floor(Math.random() * suffixes.length)]}`;
            } else {
                 // 20% Full Option
                name = `${prefixes[Math.floor(Math.random() * prefixes.length)]} ${nouns[Math.floor(Math.random() * nouns.length)]} ${suffixes[Math.floor(Math.random() * suffixes.length)]}`;
            }
            
            if (!name.includes(" ")) {
                 return name.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/ƒë/g, 'd').replace(/ƒê/g, 'D').replace(/[^a-zA-Z0-9]/g, "");
            }
            
            return name; 
        };

        // --- H·ªÜ TH·ªêNG AVATAR "V≈® TR·ª§" (T·ª∞ ƒê·ªòNG T·∫†O + KHO ·∫¢NH KH·ªîNG L·ªí) ---
        const getBotAvatar = (botName) => {
            // 1. T·ª∑ l·ªá d√πng Avatar "Ng∆∞·ªùi d√πng m·ªõi/Ch·ªØ c√°i" (20%) - R·∫•t ph·ªï bi·∫øn ·ªü web phim
            if (Math.random() < 0.2) {
                 return `https://ui-avatars.com/api/?name=${encodeURIComponent(botName)}&background=random&color=fff&size=128`;
            }

            // 2. T·ª∑ l·ªá d√πng Avatar Art x·ªãn (DiceBear - Lorelei/Notionists) (40%)
            if (Math.random() < 0.5) {
                const style = Math.random() < 0.5 ? 'lorelei' : 'notionists';
                return `https://api.dicebear.com/9.x/${style}/svg?seed=${encodeURIComponent(botName)}`;
            }

            // 3. T·ª∑ l·ªá d√πng Avatar "Fan C·ª©ng" (Logo/Nh√¢n v·∫≠t) (40%) - Gi·∫£ l·∫≠p ·∫£nh upload
            // Danh s√°ch T·ª™ KH√ìA ƒë·ªÉ t·∫°o ·∫£nh placeholder m√†u s·∫Øc (Gi·∫£ l·∫≠p ·∫£nh anime/logo)
            const keywords = [
                "Luffy", "Zoro", "Sanji", "Nami", "Robin", "Chopper", "Usopp", "Franky", "Brook", "Jinbe",
                "Goku", "Vegeta", "Gohan", "Piccolo", "Frieza", "Cell", "Buu", "Beerus", "Whis", "Broly",
                "Naruto", "Sasuke", "Sakura", "Kakashi", "Itachi", "Madara", "Obito", "Gaara", "Hinata", "Jiraiya",
                "Tanjiro", "Nezuko", "Zenitsu", "Inosuke", "Rengoku", "Giyuu", "Shinobu", "Muzan", "Akaza", "Doma",
                "Deku", "Bakugo", "Todoroki", "AllMight", "Aizawa", "Shigaraki", "Dabi", "Toga", "Twice", "Overhaul",
                "Saitama", "Genos", "Tatsumaki", "Fubuki", "King", "Bang", "Garou", "Sonic", "Mumen", "Boros",
                "Asta", "Yuno", "Yami", "Noelle", "Luck", "Magna", "Julius", "Licht", "Patry", "Zagred",
                "Rimuru", "Veldora", "Shion", "Benimaru", "Souei", "Milim", "Ramiris", "Diablo", "Guy", "Leon",
                "Kirito", "Asuna", "Sinon", "Leafa", "Yui", "Klein", "Agil", "Yuuki", "Alice", "Eugeo",
                "Eren", "Mikasa", "Armin", "Levi", "Erwin", "Hange", "Reiner", "Zeke", "Annie", "Historia",
                "Light", "L", "Ryuk", "Misa", "Near", "Mello", "Rem", "Soichiro", "Matsuda", "Aizawa",
                "Gojo", "Itadori", "Megumi", "Nobara", "Sukuna", "Maki", "Toge", "Panda", "Nanami", "Mahito",
                "Denji", "Power", "Makima", "Aki", "Pochita", "Kobeni", "Himeno", "Kishibe", "Reze", "Quanxi",
                "Anya", "Loid", "Yor", "Bond", "Damian", "Becky", "Yuri", "Fiona", "Franky", "Sylvia",
                "Wibu", "Meme", "Fan", "Otaku", "Simp", "Waifu", "Husbando", "Senpai", "Kouhai", "Sensei",
                "Admin", "Mod", "Vip", "Pro", "Noob", "Gamer", "Streamer", "Youtuber", "Tiktoker", "Facebook",
                "Anime", "Manga", "LightNovel", "Game", "Music", "Movie", "Cosplay", "Figure", "Art", "Design"
            ];
            
            const keyword = keywords[Math.floor(Math.random() * keywords.length)];
            // T·∫°o m√†u ng·∫´u nhi√™n
            const bg = Math.floor(Math.random()*16777215).toString(16);
            const fg = "ffffff";
            return `https://placehold.co/100x100/${bg}/${fg}/png?text=${keyword}`;
        };

        const BOT_INTERVAL_MS = 5000;
        const getEl = (selector) => document.querySelector(selector);
        const log = (message, type = 'info') => {
            const logsEl = getEl('#bot-logs');
            if (logsEl) {
                const color = type === 'error' ? 'text-red-400' : (type === 'success' ? 'text-lime-400' : 'text-gray-400');
                const time = new Date().toLocaleTimeString('vi-VN');
                logsEl.innerHTML = `<div class="p-2 border-b border-gray-700 ${color} flex items-start space-x-2">
                    <span>${time} | [${type.toUpperCase()}]</span>
                    <span>${message}</span>
                </div>` + logsEl.innerHTML;
            }
        };

        const isGoogleAuth = (user) => user && user.providerData.some(p => p.providerId === 'google.com');

        // Utility: T√≠nh ƒëi·ªÉm trung b√¨nh
        const calculatePerceivedScore = (movie) => {
            const total = movie.reviewTotal || 0;
            const count = movie.reviewCount || 0;
            if (count === 0) return 4.0; 
            return total / count;
        };
        
        // Utility: L·∫•y Comment cu·ªëi c√πng
        const fetchLastComment = async (movieId) => {
            try {
                const commentsColRef = collection(db, dataCollectionPath, movieId, 'comments');
                const q = query(commentsColRef, orderBy('createdAt', 'desc'), limit(1));
                const snapshot = await getDocs(q);
                if (!snapshot.empty && (Date.now() - snapshot.docs[0].data().createdAt.toDate().getTime() < 600000)) { 
                    return { id: snapshot.docs[0].id, ...snapshot.docs[0].data() };
                }
            } catch (e) {}
            return null;
        };

        // === KHO B√åNH LU·∫¨N KH·ªîNG L·ªí (MASSIVE & TRENDY) ===
        const COMMENT_POOLS = {
            ACTION: [ 
                `Combat t·∫≠p n√†y c·ªßa {title} ch√°y kh√©t l·∫πt lu√¥n üî•`, `Animation m∆∞·ª£t nh∆∞ sunsilk, xem ƒë√£ con m·∫Øt!`,
                `Main b√° ƒë·∫°o qu√°, c√¢n c·∫£ map lu√¥n r·ªìi!`, `ƒêo·∫°n ƒë√°nh nhau cu·ªëi phim ƒë√∫ng ƒë·ªânh cao, out tr√¨nh!`,
                `S·ª©c m·∫°nh t√¨nh b·∫°n l·∫°i chi·∫øn th·∫Øng trong {title} √†? üòÇ`, `H√≥ng main show skill m·ªõi trong {title} qu√°!`,
                `Studio ƒë·∫ßu t∆∞ {title} √°c th·∫≠t, hi·ªáu ·ª©ng ch√°y m√°y.`, `Nh·∫°c n·ªÅn l√∫c combat n·ªïi da g√† lu√¥n.`,
                `{title} ƒë√∫ng l√† si√™u ph·∫©m h√†nh ƒë·ªông m√πa n√†y.`, `Coi {title} m√† tim ƒë·∫≠p b·ªãch b·ªãch, h·ªìi h·ªôp x·ªâu.`,
                `Nh√¨n main m√∫a ki·∫øm trong {title} m√† s∆∞·ªõng r∆°n ng∆∞·ªùi.`, `Map {title} r·ªông th·∫ø n√†y ƒë√°nh nhau m·ªõi ƒë√£.`,
                `ƒê√°nh ƒë·∫•m th·∫ø n√†y m·ªõi l√† anime ch·ª©! 10 ƒëi·ªÉm!`, `Ch√°y qu√° anh em ∆°i! Xem m√† mu·ªën lao v√†o m√†n h√¨nh.`,
                `Main gi·∫•u ngh·ªÅ k·ªπ qu√°, bung l·ª•a c√°i l√† h·∫øt n∆∞·ªõc ch·∫•m.`, `Phim n√†y ƒë√°nh nhau √≠t n√≥i ƒë·∫°o l√Ω, ∆∞ng c√°i b·ª•ng.`,
                `Skill ƒë·∫πp, √¢m thanh ch·∫•t, {title} ƒë√∫ng l√† bom t·∫•n.`, `ƒêo·∫°n n√†y hype v√£i, xem ƒëi xem l·∫°i ch·ª•c l·∫ßn.`,
                `Th·∫±ng ph·∫£n di·ªán trong {title} c≈©ng ng·∫ßu kh√¥ng k√©m main.`, `Coi combat m√† n√≠n th·ªü, k·ªãch t√≠nh v√£i.`,
                `T·∫≠p n√†y ƒë·ªët kinh ph√≠ √°c, studio ch·∫Øc b√°n th·∫≠n l√†m phim.`, `Chuy·ªÉn c·∫£nh m∆∞·ª£t h∆°n c·∫£ Crush t·ª´ ch·ªëi t√¥i.`,
                `M·ªôt ch·ªØ th√¥i: PH√ä!`, `Xem xong mu·ªën ƒëi h·ªçc v√µ lu√¥n :)))`, `Coi m√† mu·ªën g√£y c√°i gh·∫ø v√¨ qu√° s∆∞·ªõng!`,
                `M√†n solo n√†y ƒëi v√†o l·ªãch s·ª≠ anime r·ªìi!`, `Top 1 server l√† ƒë√¢y ch·ª© ƒë√¢u!`,
                `Nh√¨n thanh m√°u t·ª•t kh√¥ng phanh m√† s∆∞·ªõng.`, `Combo ƒë·∫πp m·∫Øt qu√°, h·ªçc h·ªèi ngay!`,
                `ƒê√∫ng l√† si√™u ph·∫©m shounen, kh√¥ng u·ªïng c√¥ng c√†y.`, `Main ng·∫ßu l√≤i, v·ª£ tui ∆°i!`,
                `C·∫£nh n√†y ph·∫£i tua l·∫°i 10 l·∫ßn m·ªõi ƒë√£ n∆∞.`, `ƒê·ªânh cao c·ªßa ngh·ªá thu·∫≠t ƒë√°nh ƒë·∫•m.`,
                `Hi·ªáu ·ª©ng ch√°y n·ªï l√†m tui ch√≥i c·∫£ m·∫Øt.`, `√Çm thanh s·ªëng ƒë·ªông nh∆∞ ƒëang ·ªü chi·∫øn tr∆∞·ªùng.`
            ],
            ROMANCE: [ 
                `C∆°m tr√≥ ng·∫≠p m·ªìm, F.A nh∆∞ tui t·ª©c √°! üê∂`, `Ng·ªçt s√¢u rƒÉng lu√¥n r·ªìi, c·ª©u tui v·ªõi!`,
                `C·∫∑p ƒë√¥i ch√≠nh trong {title} d·ªÖ th∆∞∆°ng x·ªâu up x·ªâu down.`, `Thuy·ªÅn n√†y bao real, kh√¥ng l√™n thuy·ªÅn l√† ph√≠!`,
                `Xem {title} m√† qu·∫Øn qu√©o h·∫øt c·∫£ ng∆∞·ªùi.`, `ƒê·ª´ng drama n·ªØa m√†, cho h·ªç h·∫°nh ph√∫c ƒëi! üò≠`,
                `T√¨nh y√™u trong {title} ƒë·∫πp qu√°, ∆∞·ªõc g√¨ m√¨nh ƒë∆∞·ª£c nh∆∞ v·∫≠y.`, `Nh√¨n √°nh m·∫Øt nam ch√≠nh nh√¨n n·ªØ ch√≠nh k√¨a, soft x·ªâu!`,
                `K·∫øt th√∫c {title} m√† kh√¥ng HE l√† tui ƒë·ªët nh√† t√°c gi·∫£ √°!`, `Chu·∫©n b·ªã khƒÉn gi·∫•y tr∆∞·ªõc khi xem {title} nha m·∫•y b√†.`,
                `{title} t·∫≠p n√†y l√†m tui nh·ªõ ng∆∞·ªùi y√™u c≈© qu√°...`, `Tr·ªùi ∆°i chemistry c·ªßa 2 ƒë·ª©a trong {title} ƒë·ªânh v√£i.`,
                `Tui mu·ªën c√≥ ng∆∞·ªùi y√™u ngay l·∫≠p t·ª©c sau khi xem {title}!`, `Ng·ªçt nh∆∞ ƒë∆∞·ªùng ph√®n, xem m√† c∆∞·ªùi t·ªßm t·ªâm.`,
                `C·∫©u l∆∞∆°ng ch·∫•t l∆∞·ª£ng cao, ƒÉn m√£i kh√¥ng ch√°n.`, `Nam ph·ª• trong {title} c≈©ng ngon trai, ti·∫øc l√† friendzone.`,
                `T√¨nh ti·∫øt nh·∫π nh√†ng, ch·ªØa l√†nh t√¢m h·ªìn F.A.`, `Xem xong mu·ªën y√™u ƒë∆∞∆°ng li·ªÅn, phim h·∫°i ng∆∞·ªùi qu√° :))`,
                `C·ª©u t√¥i, t√¥i ƒëang ch√¨m trong s·ª± ng·ªçt ng√†o n√†y.`, `M√°u m≈©i t√¥i tu√¥n r∆°i v√¨ s·ª± cute n√†y.`,
                `H√¥n nhau ƒëi, h√¥n nhau ƒëi!`, `T·ªè t√¨nh ƒëi tr·ªùi ∆°i, s·ªët ru·ªôt qu√°!`,
                `Sao m√† c·ª© v·ªùn nhau m√£i th·∫ø n√†y, tui ƒëau tim qu√°.`, `Th√≠ch th√¨ nh√≠ch ƒëi, ng·∫°i ng√πng g√¨ n·ªØa!`,
                `OTP n√†y m√† kh√¥ng real tui ƒëi ƒë·∫ßu xu·ªëng ƒë·∫•t.`, `D·ªÖ th∆∞∆°ng mu·ªën x·ªâu, tim tui tan ch·∫£y r·ªìi.`,
                `∆Ø·ªõc g√¨ c√≥ anh ng∆∞·ªùi y√™u nh∆∞ nam ch√≠nh.`, `N·ªØ ch√≠nh xinh qu√°, mu·ªën b·∫Øt v·ªÅ nu√¥i.`,
                `Phim n√†y kh√¥ng d√†nh cho ng∆∞·ªùi c√¥ ƒë∆°n.`, `Tui ƒëang GATO v·ªõi nh√¢n v·∫≠t ch√≠nh ƒë√¢y n√†y.`
            ],
            ISEKAI: [ 
                `L·∫°i l√† xe t·∫£i-kun l√†m vi·ªác nƒÉng su·∫•t trong {title} :))`, `Main {title} hack game √†? Sao m·∫°nh v√¥ l√Ω v·∫≠y?`,
                `∆Ø·ªõc g√¨ ƒë∆∞·ª£c isekai v√†o th·∫ø gi·ªõi {title} l√†m slime c≈©ng ch·ªãu.`, `Harem c·ªßa main trong {title} ch·∫•t l∆∞·ª£ng qu√°!`,
                `Th·∫ø gi·ªõi trong {title} x√¢y d·ª±ng ƒë·ªânh gh√™.`, `Skill c·ªßa main ·∫£o ma canada qu√°.`,
                `Ma v∆∞∆°ng trong {title} nh√¨n hi·ªÅn kh√¥ v·∫≠y?`, `B·ªô {title} n√†y ƒë√∫ng chu·∫©n power fantasy, xem gi·∫£i tr√≠ t·ªët.`,
                `Chuy·ªÉn sinh th√†nh c√°i g√¨ kh√¥ng th√†nh, l·∫°i th√†nh... trong {title} üòÇ`, `Ti·ªÅn t·ªá trong {title} l·∫°m ph√°t qu√° :))`,
                `Main b√° ƒë·∫°o tr√™n t·ª´ng h·∫°t g·∫°o, xem s∆∞·ªõng m·∫Øt.`, `Th·∫ø gi·ªõi game trong {title} chi ti·∫øt ph·∫øt.`,
                `Isekai gi·ªù b√£o h√≤a r·ªìi m√† {title} v·∫´n cu·ªën l·∫° th∆∞·ªùng.`, `Main kh√¥ng c·∫ßn c√†y cu·ªëc c≈©ng m·∫°nh, ∆∞·ªõc g√¨ m√¨nh ƒë∆∞·ª£c v·∫≠y.`,
                `M·∫•y em elf trong {title} xinh x·ªâu.`, `H√≥ng main x√¢y d·ª±ng v∆∞∆°ng qu·ªëc ri√™ng.`,
                `Truck-kun is MVP.`, `Cu·ªôc s·ªëng m·ªõi ·ªü d·ªã gi·ªõi s∆∞·ªõng th·∫ø n√†y th√¨ ai ch·∫£ mu·ªën.`,
                `Main n√†y s·ªë h∆∞·ªüng v√£i, to√†n g√°i xinh v√¢y quanh.`, `Skill n√†y b√° ƒë·∫°o qu√°, c√¢n c·∫£ server.`,
                `Th·∫ø gi·ªõi n√†y th√∫ v·ªã ph·∫øt, mu·ªën v√†o ch∆°i th·ª≠.`, `H·ªá th·ªëng game trong phim l√†m tui nh·ªõ ƒë·∫øn...`,
                `ƒê√∫ng ch·∫•t isekai m√¨ ƒÉn li·ªÅn, nh∆∞ng m√† ngon.`, `Xem gi·∫£i tr√≠, kh√¥ng c·∫ßn n√£o nhi·ªÅu.`,
                `Main gi·∫•u ngh·ªÅ, gi·∫£ heo ƒÉn th·ªãt h·ªï kinh v√£i.`, `Khi n√†o main m·ªõi l·ªô s·ª©c m·∫°nh th·∫≠t ƒë√¢y?`
            ],
            HORROR: [ 
                `Xem {title} l√∫c n·ª≠a ƒë√™m ƒë√∫ng l√† sai l·∫ßm, s·ª£ v√£i linh h·ªìn üò±`, `Plot twist c·ªßa {title} l√†m tui tr·∫ßm c·∫£m lu√¥n.`,
                `Kh√¥ng kh√≠ trong {title} u √°m gh√™, l·∫°nh s·ªëng l∆∞ng.`, `C√°i k·∫øt c·ªßa {title} dark qu√°, √°m ·∫£nh th·ª±c s·ª±.`,
                `Ai y·∫øu tim ƒë·ª´ng xem {title} nha, c·∫£nh b√°o tr∆∞·ªõc!`, `Nh·∫°c phim {title} nghe r·ª£n ng∆∞·ªùi.`,
                `T√°c gi·∫£ {title} n√£o to th·∫≠t, hack n√£o ng∆∞·ªùi xem.`, `Thao t√∫ng t√¢m l√Ω c·ª±c m·∫°nh, {title} qu√° ƒë·ªânh.`,
                `M√°u me be b√©t, {title} kh√¥ng d√†nh cho tr·∫ª em ƒë√¢u.`, `T·ªëi nay m·∫•t ng·ªß v√¨ {title} r·ªìi...`,
                `Jump scare t·∫≠p n√†y l√†m tui r·ªõt ƒëi·ªán tho·∫°i.`, `C·ªët truy·ªán {title} b·ªánh ho·∫°n th·∫≠t s·ª±, nh∆∞ng m√† cu·ªën.`,
                `Nh√¨n con qu√°i trong {title} m√† n·ªïi da g√†.`, `Phim n√†y xem xong kh√¥ng d√°m ƒëi v·ªá sinh m·ªôt m√¨nh.`,
                `ƒêang xem th√¨ con m√®o nh·∫£y l√™n, x√©m x·ªâu.`, `C·∫£m gi√°c nh∆∞ c√≥ ai ƒëang nh√¨n m√¨nh khi xem {title}.`,
                `T·ªüm l·ª£m nh∆∞ng m√† hay.`, `T√¢m l√Ω nh√¢n v·∫≠t m√©o m√≥ v√£i.`,
                `C√°i k·∫øt l√†m tui ƒë·ª©ng h√¨nh 5 gi√¢y.`, `Kh√¥ng d√°m t·∫Øt ƒë√®n ƒëi ng·ªß lu√¥n.`,
                `Phim n√†y √°m ·∫£nh qu√°, ch·∫Øc ph·∫£i xem phim h√†i ƒë·ªÉ t·∫©y n√£o.`, `Gh√™ r·ª£n nh∆∞ng kh√¥ng th·ªÉ ng·ª´ng xem.`,
                `T√°c gi·∫£ ch·∫Øc c√≥ v·∫•n ƒë·ªÅ t√¢m l√Ω m·ªõi nghƒ© ra ƒë∆∞·ª£c c√°i n√†y.`, `S·ª£ qu√° m√† v·∫´n mu·ªën xem ti·∫øp.`
            ],
            COMEDY: [ 
                `C∆∞·ªùi ·ªâa v·ªõi {title}, t·∫•u h√†i c·ª±c m·∫°nh üòÇ`, `ƒêang ƒÉn c∆°m xem {title} m√† s·∫∑c m·∫•y l·∫ßn.`,
                `Th√°nh meme m·ªõi l√† ƒë√¢y ch·ª© ƒë√¢u!`, `Xem {title} x·∫£ stress hi·ªáu qu·∫£ l·∫Øm nha.`,
                `ƒê·ªô l·∫ßy c·ªßa main trong {title} l√† v√¥ ƒë·ªëi.`, `C∆∞·ªùi mu·ªën n·ªôi th∆∞∆°ng v·ªõi t·∫≠p n√†y c·ªßa {title}.`,
                `Nh√¢n v·∫≠t ph·ª• trong {title} c√≤n m·∫∑n h∆°n c·∫£ main.`, `B·ªô n√†y anti-stress c·ª±c m·∫°nh, khuy·∫øn kh√≠ch xem.`,
                `M·∫∑t √¥ng main l√∫c ƒë√≥ nh√¨n b·ª±a v√£i ch∆∞·ªüng.`, `H√†i ·∫ª, t√°c gi·∫£ ch·∫Øc c≈©ng h√∫t c·∫ßn m·ªõi v·∫Ω ƒë∆∞·ª£c nh∆∞ n√†y.`,
                `C∆∞·ªùi kh√¥ng nh·∫∑t ƒë∆∞·ª£c m·ªìm lu√¥n √° tr·ªùi.`, `Phim g√¨ m√† l·∫ßy l·ªôi d·ªØ th·∫ßn.`,
                `C∆∞·ªùi ƒëau c·∫£ b·ª•ng, ai ƒë·ªÅn cho tui ƒëi.`, `Xem phim m√† c∆∞·ªùi nh∆∞ ƒëi√™n, ng∆∞·ªùi nh√† t∆∞·ªüng b·ªã g√¨.`
            ],
            GENERAL: [ // Chung chung, Meme, Trend (R·∫§T NHI·ªÄU)
                `{title} m√£i ƒë·ªânh! M√£i m·∫≠n xo√†i c√≥c ·ªïi!`, `Keo l·ª≥ t√°i ch√¢u lu√¥n √°!`,
                `Xem {title} xong tui b·ªã "suy" lu√¥n r·ªìi... ü•Ä`, `Flex nh·∫π c√°i acc ƒë√£ c√†y {title} 3 l·∫ßn üòé`,
                `Ai r·ªìi c≈©ng ph·∫£i xem {title} th√¥i, quy lu·∫≠t v≈© tr·ª• r·ªìi.`, `Check var g·∫•p ƒëo·∫°n cu·ªëi {title} anh em ∆°i!`,
                `{title} l√†m tui overthinking m·∫•t 3 ng√†y.`, `Th√† nh·ªãn ƒÉn ch·ª© kh√¥ng nh·ªãn xem {title}!!!`,
                `H√≥ng t·∫≠p sau qu√° ad ∆°i!`, `Phim hay v√£i ch∆∞·ªüng.`, `10 ƒëi·ªÉm v·ªÅ ch·ªó!`,
                `M·∫•y √¥ng ch√™ {title} ch·∫Øc ch∆∞a xem h·∫øt t·∫≠p 1 r·ªìi.`, `Si√™u ph·∫©m {title} n√†y m√† kh√¥ng n·ªïi th√¨ h∆°i ph√≠.`,
                `Web xem m∆∞·ª£t qu√°, c·∫£m ∆°n ad!`, `Subteam d·ªãch {title} c√≥ t√¢m gh√™.`,
                `H·∫£o anime!`, `Tuy·ªát v·ªùi √¥ng m·∫∑t tr·ªùi.`, `Qu√° ƒë√£ pepsi ∆°i.`,
                `ƒê·ªânh c·ªßa ch√≥p!`, `Kh√©t l·∫πt!`, `Ch·∫•t l∆∞·ª£ng!`,
                `Ai spoil {title} tui block r√°ng ch·ªãu nha.`, `T·∫≠p n√†y xem xong l√∫ lu√¥n.`,
                `C·∫ßn t√¨m info b√†i h√°t ƒëo·∫°n gi·ªØa phim {title}.`, `Xem {title} ·ªü ƒë√¢y l√† chu·∫©n b√†i r·ªìi.`,
                `M·ªçi ng∆∞·ªùi ∆°i, {title} c√≥ manga kh√¥ng?`, `Ad ∆°i, ra t·∫≠p m·ªõi nhanh l√™n!`,
                `Phim n√†y cu·ªën h∆°n b√°nh cu·ªën b√† T√¢n.`, `Nh√¨n visual nh√¢n v·∫≠t m√† mu·ªën r·ª•ng tim.`,
                `Tui l√† ng∆∞·ªùi ƒë∆°n gi·∫£n, th·∫•y {title} l√† tui click.`, `U l√† tr·ªùi, c√°i ƒëo·∫°n ƒë√≥ hay x·ªâu.`,
                `M√™ ch·ªØ √™ k√©o d√†i nha.`, `ƒêang h·ªçc b√†i m√† ph·∫£i l√©n xem {title} n√®.`,
                `Phim n√†y ai kh√¥ng xem l√† ph√≠ n·ª≠a ƒë·ªùi ng∆∞·ªùi.`, `Ch·∫•m h√≥ng!`,
                `Xin l·ªãch chi·∫øu {title} v·ªõi ad ∆°i.`, `C√≥ ai bi·∫øt phim n√†o gi·ªëng {title} kh√¥ng?`,
                `Xem {title} xong th·∫•y y√™u ƒë·ªùi h·∫≥n.`, `C√†y l·∫°i l·∫ßn N v·∫´n th·∫•y hay.`,
                `Kh√¥ng xem {title} l√† m·ªôt thi·∫øu s√≥t l·ªõn.`, `Phim hay th·∫ø n√†y m√† gi·ªù m·ªõi bi·∫øt.`,
                `Ai ch∆∞a xem th√¨ xem ƒëi nh√©, kh√¥ng h·ªëi h·∫≠n ƒë√¢u.`, `Si√™u ph·∫©m trong l√≤ng t√¥i.`,
                `Tri·ªáu like cho {title}!`, `C·∫£m x√∫c d√¢ng tr√†o, tuy·ªát v·ªùi!`,
                `Kh√¥ng u·ªïng c√¥ng th·ª©c ƒë√™m c√†y {title}.`, `Ch·∫•m 100 ƒëi·ªÉm cho s·ª± n·ªó l·ª±c c·ªßa studio.`,
                `Phim n√†y m√† kh√¥ng top trending th√¨ h∆°i l·∫°.`, `Fan {title} ƒëi·ªÉm danh n√†o!`,
                `Nh√¨n d√†n harem m√† th√®m.`, `Main ng·∫ßu l√≤i, kh√¥ng n√≥i nhi·ªÅu.`,
                `Waifu qu·ªëc d√¢n ƒë√¢y r·ªìi!`, `Husband c·ªßa emmm!`,
                `T√¨nh ti·∫øt phim nhanh, g·ªçn, l·∫π.`, `Kh√¥ng c√≥ m·ªôt gi√¢y n√†o th·ª´a th·∫£i.`,
                `L·∫ßn ƒë·∫ßu xem anime m√† cu·ªën th·∫ø n√†y.`, `Gi·ªõi thi·ªáu cho c·∫£ l·ªõp xem lu√¥n.`,
                `Phim hay, nh·∫°c hay, nh√¢n v·∫≠t ƒë·∫πp. Combo h·ªßy di·ªát.`, `Xem xong mu·ªën mua figure li·ªÅn.`,
                `Ad c·∫≠p nh·∫≠t nhanh qu√°, y√™u ad!`, `Web x·ªãn, kh√¥ng qu·∫£ng c√°o, 10 ƒëi·ªÉm.`
            ],
            NEGATIVE: [ // Ch√™ bai, Th·∫•t v·ªçng (R·∫§T NHI·ªÄU)
                `{title} ƒë√∫ng l√† phim r√°c, ph√≠ th·ªùi gian.`, `Art {title} x·∫•u ƒëau ƒë·ªõn, x√∫c ph·∫°m ng∆∞·ªùi nh√¨n.`,
                `C·ªët truy·ªán {title} nh·∫°t nh∆∞ n∆∞·ªõc ·ªëc. Drop g·∫•p!`, `Di·ªÖn bi·∫øn t√¢m l√Ω nh√¢n v·∫≠t trong {title} v√¥ l√Ω ƒë√πng ƒë√πng.`,
                `Th·∫•t v·ªçng tr√†n tr·ªÅ v·ªÅ {title}.`, `Ai cho tui xin l·∫°i th·ªùi gian xem {title} ƒëi. Refund!!!`,
                `Anh Hai n√≥i th·∫≥ng, {title} l√† phim r√°c.`, `Th√¥i xong {title} r·ªìi, ch·∫•t l∆∞·ª£ng nh∆∞ Ph·ªü b·ªã ngu·ªôi.`,
                `ƒê·ª´ng xem {title}, h·ªëi h·∫≠n ƒë·∫•y.`, `2 sao cho s·ª± c·ªë g·∫Øng, c√≤n l·∫°i th√¨ t·ªá.`,
                `Xem ƒë∆∞·ª£c n·ª≠a t·∫≠p {title} t·∫Øt lu√¥n, kh√¥ng nu·ªët n·ªïi.`, `Buff b·∫©n cho main qu√° ƒë√†, xem ch√°n.`,
                `Logic phim {title} ƒë·ªÉ ƒë√¢u r·ªìi?`, `Th√† xem qu·∫£ng c√°o c√≤n h∆°n xem {title}.`,
                `Sub d·ªü, phim d·ªü, combo h·ªßy di·ªát.`, `Ph√≠ ti·ªÅn m·∫°ng xem {title}.`,
                `N·ªôi dung s√°o r·ªóng, to√†n fan service r·∫ª ti·ªÅn.`, `Main ph·∫ø v·∫≠t, xem m√† ·ª©c ch·∫ø.`,
                `K·∫øt th√∫c {title} l√£ng x·∫πt, ƒë·∫ßu voi ƒëu√¥i chu·ªôt.`, `ƒê·ª´ng ai tin m·∫•y c√°i review khen l·∫•y khen ƒë·ªÉ, to√†n seeding ƒë·∫•y.`,
                `Phim n√†y flop l√† ƒë√∫ng r·ªìi, ch·∫£ c√≥ g√¨ ƒë·∫∑c s·∫Øc.`, `T·∫©y chay {title} v√¨ n·ªôi dung xuy√™n t·∫°c.`,
                `Xem {title} bu·ªìn ng·ªß kinh kh·ªßng.`, `Nh√¢n v·∫≠t n·ªØ trong {title} b√°nh b√®o v√¥ d·ª•ng v√£i.`,
                `Ch√°n ch·∫≥ng bu·ªìn n√≥i.`, `C·ªët truy·ªán r·ªùi r·∫°c, ch·∫£ hi·ªÉu g√¨.`,
                `ƒê·ªì h·ªça nh∆∞ phim ho·∫°t h√¨nh nh·ªØng nƒÉm 2000.`, `Th·∫•t v·ªçng to√†n t·∫≠p.`,
                `Kh√¥ng hi·ªÉu sao {title} l·∫°i ƒë∆∞·ª£c khen, tui th·∫•y d·ªü t·ªá.`, `ƒê·∫°o di·ªÖn ch·∫Øc ƒëang ng·ªß g·∫≠t l√∫c l√†m phim n√†y.`,
                `K·ªãch b·∫£n nh∆∞ vi·∫øt cho tr·∫ª con xem.`, `Nh√¢n v·∫≠t ph·ª• c√≤n c√≥ n√£o h∆°n nh√¢n v·∫≠t ch√≠nh.`,
                `Xem m√† t·ª©c c√°i l·ªìng ng·ª±c.`, `Phim g√¨ m√† dark deep n·ª≠a m√πa.`,
                `C·ªë t·ªè ra nguy hi·ªÉm nh∆∞ng th·ª±c ch·∫•t r·ªóng tu·∫øch.`, `Ph√≠ ph·∫°m t√†i nguy√™n.`,
                `Th√¥i d·∫πp, ngh·ªâ kh·ªèe.`, `Kh√¥ng bao gi·ªù xem l·∫°i l·∫ßn 2.`,
                `Phim r√°c r∆∞·ªüi, ƒë·ª´ng ai xem.`, `T·ªá h·∫°i, kh√¥ng c√≤n t·ª´ g√¨ ƒë·ªÉ di·ªÖn t·∫£.`,
                `L√†m phim ki·ªÉu g√¨ v·∫≠y tr·ªùi?`, `C√†ng xem c√†ng th·∫•y ch√°n.`,
                `Drop t·ª´ t·∫≠p 1, bye.`, `ƒê·ª´ng ƒë·ªÉ c√°i poster l·ª´a t√¨nh.`
            ]
        };

        const getCommentContentByGenre = (movie) => {
            const genres = (movie.genre || "").toLowerCase();
            let pool = [...COMMENT_POOLS.GENERAL]; 

            if (genres.includes("h√†nh ƒë·ªông") || genres.includes("action")) pool = pool.concat(COMMENT_POOLS.ACTION);
            if (genres.includes("t√¨nh c·∫£m") || genres.includes("romance")) pool = pool.concat(COMMENT_POOLS.ROMANCE);
            if (genres.includes("chuy·ªÉn sinh") || genres.includes("isekai")) pool = pool.concat(COMMENT_POOLS.ISEKAI);
            if (genres.includes("kinh d·ªã") || genres.includes("horror")) pool = pool.concat(COMMENT_POOLS.HORROR);
            if (genres.includes("h√†i") || genres.includes("comedy")) pool = pool.concat(COMMENT_POOLS.COMEDY);

            // T·ª∑ l·ªá ch√™ bai (15%)
            if (Math.random() < 0.15) pool = COMMENT_POOLS.NEGATIVE;

            const template = pool[Math.floor(Math.random() * pool.length)];
            return template.replace(/{title}/g, movie.title);
        };

        // --- REVIEW THEO TH·ªÇ LO·∫†I & ƒêI·ªÇM S·ªê (LOGIC M·ªöI - B·ªî SUNG NHI·ªÄU) ---
        const getReviewContentByGenre = (movie, rating) => {
            const genres = (movie.genre || "").toLowerCase();
            const title = movie.title;
            
            // 5 SAO & 4 SAO (KHEN)
            if (rating >= 4) {
                if (genres.includes("h√†nh ƒë·ªông")) return `Combat trong ${title} qu√° m√£n nh√£n, 10/10 animation! ƒê·ªânh c·ªßa ch√≥p! ƒê√£ m·∫Øt th·∫≠t s·ª±.`;
                if (genres.includes("t√¨nh c·∫£m")) return `${title} l√†m tui kh√≥c h·∫øt n∆∞·ªõc m·∫Øt, nh∆∞ng m√† hay. C∆°m tr√≥ ch·∫•t l∆∞·ª£ng! ƒê·ªÅ c·ª≠.`;
                if (genres.includes("isekai")) return `M√™ th·∫ø gi·ªõi fantasy trong ${title} qu√°, mu·ªën ƒë∆∞·ª£c chuy·ªÉn sinh ngay v√† lu√¥n! X√¢y d·ª±ng world ngon.`;
                if (genres.includes("kinh d·ªã")) return `${title} √°m ·∫£nh th·ª±c s·ª±, c·ªët truy·ªán hack n√£o. ƒê·ªÅ c·ª≠ m·∫°nh cho ai gan d·∫°!`;
                if (genres.includes("h√†i")) return `C∆∞·ªùi x·ªâu v·ªõi ${title}, gi·∫£i tr√≠ c·ª±c t·ªët. M√£i m·∫≠n! C∆∞·ªùi mu·ªën r·ªõt h√†m.`;
                const generalPraise = [
                    `${title} qu√° xu·∫•t s·∫Øc, kh√¥ng xem ph√≠ ƒë·ªùi. Fan c·ª©ng ƒëi·ªÉm danh! Web load nhanh, phim hay. ƒê·ªì h·ªça ƒë·∫πp, √¢m thanh s·ªëng ƒë·ªông.`,
                    `Tuy·ªát ph·∫©m! ${title} ƒë√£ ch·∫°m ƒë·∫øn tr√°i tim t√¥i. M·ªçi th·ª© ƒë·ªÅu ho√†n h·∫£o.`,
                    `Kh√¥ng th·ªÉ r·ªùi m·∫Øt kh·ªèi m√†n h√¨nh. ${title} l√¥i cu·ªën t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi.`,
                    `M·ªôt b·ªô anime ƒë√°ng ƒë·ªìng ti·ªÅn b√°t g·∫°o. ${title} m√£i ƒë·ªânh!`,
                    `T√¥i s·∫Ω gi·ªõi thi·ªáu ${title} cho t·∫•t c·∫£ b·∫°n b√® c·ªßa t√¥i. Qu√° hay!`,
                    `Kh√¥ng c√≥ ƒëi·ªÉm tr·ª´ n√†o cho ${title}. M·ªôt tr·∫£i nghi·ªám tuy·ªát v·ªùi.`,
                    `Ch·∫Øc ch·∫Øn s·∫Ω xem l·∫°i ${title} nhi·ªÅu l·∫ßn n·ªØa. Qu√° hay!`,
                    `T·ª´ng chi ti·∫øt trong ${title} ƒë·ªÅu ƒë∆∞·ª£c chƒÉm ch√∫t k·ªπ l∆∞·ª°ng. 10 ƒëi·ªÉm!`,
                    `C·∫£m ∆°n v√¨ ƒë√£ t·∫°o ra ${title}. N√≥ ƒë√£ c·ª©u r·ªói t√¢m h·ªìn t√¥i.`,
                    `M·ªôt trong nh·ªØng b·ªô anime hay nh·∫•t m√¨nh t·ª´ng xem. R·∫•t ƒë√°ng xem!`
                ];
                return generalPraise[Math.floor(Math.random() * generalPraise.length)];
            }
            
            // 3 SAO (TRUNG B√åNH)
            if (rating === 3) {
                if (genres.includes("h√†nh ƒë·ªông")) return `Combat t·∫°m ƒë∆∞·ª£c nh∆∞ng c·ªët truy·ªán ${title} h∆°i lo√£ng. C·∫ßn c·∫£i thi·ªán th√™m.`;
                if (genres.includes("t√¨nh c·∫£m")) return `${title} h∆°i s·∫øn, nhi·ªÅu ƒëo·∫°n t√¨nh ti·∫øt b·ªã g∆∞·ª£ng √©p. Xem gi·∫£i tr√≠ th√¨ ·ªïn.`;
                return `${title} xem t·∫°m ·ªïn, nh∆∞ng ƒëo·∫°n gi·ªØa h∆°i d√†i d√≤ng. C·∫ßn c·∫£i thi·ªán nh·ªãp phim. Kh√¥ng qu√° ƒë·∫∑c s·∫Øc.`;
            }
            
            // 2 SAO (CH√ä)
            if (rating === 2) {
                if (genres.includes("h√†nh ƒë·ªông")) return `Animation c·ªßa ${title} c·ª©ng ƒë∆°, combat nh∆∞ m√∫a r·ªëi. Th·∫•t v·ªçng! PowerPoint √†?`;
                if (genres.includes("t√¨nh c·∫£m")) return `N·ªôi dung ${title} s·∫øn s√∫a, t√¨nh ti·∫øt c·∫©u huy·∫øt v√¥ l√Ω. Ch√™!`;
                const generalHate = [
                    `Phim ${title} n√†y ch√°n nh∆∞ Ph·ªü, anh hai th·∫•y kh√¥ng ·ªïn ch√∫t n√†o. Drop! Ph√≠ th·ªùi gian qu√°.`,
                    `Th·ª±c s·ª± th·∫•t v·ªçng v·ªõi ${title}. Kh√¥ng hi·ªÉu sao l·∫°i n·ªïi ƒë∆∞·ª£c.`,
                    `K·ªãch b·∫£n ${title} qu√° t·ªá, ƒë·∫ßy l·ªó h·ªïng. Kh√¥ng nu·ªët tr√¥i.`,
                    `ƒê·ª´ng xem ${title}, ph√≠ th·ªùi gian l·∫Øm.`,
                    `${title} l√† m·ªôt s·ª± s·ªâ nh·ª•c ƒë·ªëi v·ªõi nguy√™n t√°c.`,
                    `Kh√¥ng th·ªÉ xem n·ªïi qu√° 3 t·∫≠p. ${title} qu√° ch√°n.`,
                    `Nh√¢n v·∫≠t ch√≠nh trong ${title} qu√° ngu ng·ªëc, xem m√† ·ª©c ch·∫ø.`,
                    `ƒê·ªì h·ªça x·∫•u, n·ªôi dung d·ªü, √¢m thanh t·ªá. Combo h·ªßy di·ªát c·ªßa ${title}.`,
                    `Ti·∫øc cho th·ªùi gian ƒë√£ b·ªè ra ƒë·ªÉ xem ${title}.`,
                    `T·∫©y chay ${title}, l√†m h·ªèng c·∫£ m·ªôt th∆∞∆°ng hi·ªáu.`
                ];
                return generalHate[Math.floor(Math.random() * generalHate.length)];
            }
            return `${title} flop qu√°. Kh√¥ng ƒë√°ng xem.`;
        };

        const getRandomReplyContent = (movieTitle, lastComment) => {
             const lastCommentContent = (lastComment.content || "").toLowerCase();
             if (lastCommentContent.includes("phim r√°c") || lastCommentContent.includes("d·ªü") || lastCommentContent.includes("t·ªá")) {
                 return `Sao b·∫°n l·∫°i ch√™ {title} gh√™ v·∫≠y? Tui th·∫•y c≈©ng ·ªïn m√†! ü§î Gu m·ªói ng∆∞·ªùi m·ªói kh√°c th√¥i.`;
             }
             else if (lastCommentContent.includes("ƒë·ªânh") || lastCommentContent.includes("hay") || lastCommentContent.includes("tuy·ªát")) {
                 return `Chu·∫©n lu√¥n! {title} l√† si√™u ph·∫©m m√πa n√†y r·ªìi! üî• C√†y n√°t m√°y lu√¥n.`;
             }
             else if (lastCommentContent.includes("h√≥ng") || lastCommentContent.includes("khi n√†o") || lastCommentContent.includes("bao gi·ªù")) {
                 return `Tui c≈©ng ƒëang h√≥ng {title} m√≤n m·ªèi ƒë√¢y n√®! C√πng c·∫£nh ng·ªô T.T`;
             }
             const REPLY_TEMPLATES = [
                `ƒê·ªìng quan ƒëi·ªÉm v·ªÅ {title}!`, `Tui c≈©ng nghƒ© y chang b·∫°n lun.`,
                `Kh√¥ng th·ªÉ ƒë·ªìng √Ω h∆°n! {title} m√£i ƒë·ªânh.`, `B√°c n√≥i chu·∫©n v√£i.`,
                `Rep cmt d·∫°o: {title} hay th·∫≠t s·ª±.`, `Chu·∫©n c∆°m m·∫π n·∫•u!`,
                `B·∫°n n√≥i ch√≠ ph·∫£i.`, `Comment ch·∫•t l∆∞·ª£ng qu√°!`,
                `Like m·∫°nh cho comment n√†y.`, `K·∫øt b·∫°n giao l∆∞u ƒëi √¥ng ∆°i.`,
                `+1 Respect.`, `Chu·∫©n kh√¥ng c·∫ßn ch·ªânh.`,
                `B√°c n√≥i h·ªô l√≤ng t√¥i.`, `Qu√° ƒë√∫ng lu√¥n!`
             ];
             const randomTemplate = REPLY_TEMPLATES[Math.floor(Math.random() * REPLY_TEMPLATES.length)];
             return randomTemplate.replace(/{title}/g, movieTitle);
        };

        const getRandomReviewContentAiring = (movieTitle) => {
            const AIRING_REVIEW_TEMPLATES = [
                `ƒê√£ set l·ªãch xem {title} ngay khi ra m·∫Øt! Trailer qu√° cu·ªën, h·ª©a h·∫πn si√™u ph·∫©m.`,
                `5 sao cho {title} v√¨ d√†n seiyuu kh·ªßng v√† art tuy·ªát v·ªùi. H√≥ng t·ª´ng ng√†y!`,
                `{title} ch·∫Øc ch·∫Øn s·∫Ω l√† anime of the season. ƒê·∫∑t g·∫°ch h√≥ng t·∫≠p 1.`,
                `Nghe ƒë·ªìn {title} c√≥ c·ªët truy·ªán si√™u hack n√£o, tui ƒë√£ chu·∫©n b·ªã tinh th·∫ßn ƒë·ªÉ overthinking r·ªìi!`,
                `Ch·ªù ƒë·ª£i {title} t·ª´ nƒÉm ngo√°i r·ªìi! Ph·∫£i ch·∫•m 5 sao ·ªßng h·ªô s·ª± tr·ªü l·∫°i n√†y.`,
                `{title} l√† hy v·ªçng cu·ªëi c√πng c·ªßa tui trong nƒÉm nay. Kh√¥ng ƒë∆∞·ª£c flop nha!`,
                `Phim {title} n√†y ph·∫£i g·ªçi l√† 'm√£i m·∫≠n', h√≥ng ng√†y ra m·∫Øt ƒë·ªÉ c√†y view.`,
                `Tuy·ªát ƒë·ªëi kh√¥ng th·ªÉ b·ªè qua {title}! ƒê√£ l∆∞u v√†o list Must Watch.`,
                `Nh√¨n poster {title} l√† th·∫•y uy t√≠n r·ªìi.`, `H√≥ng {title} ra m·∫Øt ƒë·ªÉ c√†y xuy√™n ƒë√™m.`,
                `Mong l√† {title} kh√¥ng l√†m tui th·∫•t v·ªçng.`, `Trailer ƒë·ªânh qu√°, 10 ƒëi·ªÉm visual!`,
                `ƒê·∫øm ng∆∞·ª£c t·ª´ng ng√†y ƒë·ªÉ ƒë∆∞·ª£c xem {title}.`, `Hy v·ªçng {title} s·∫Ω b√πng n·ªï.`
            ];
            return AIRING_REVIEW_TEMPLATES[Math.floor(Math.random() * AIRING_REVIEW_TEMPLATES.length)].replace(/{title}/g, movieTitle);
        };
        
        // === H√ÄM X·ª¨ L√ù H√ÄNH ƒê·ªòNG BOT ===
        
        const simulateView = (movie) => {
            if (movie.status === 'sap-chieu') return;
            const movieDocRef = doc(db, dataCollectionPath, movie.id);
            updateDoc(movieDocRef, { viewCount: increment(1) })
                .then(() => log(`[VIEW] ƒê√£ xem: "${movie.title}"`, 'success'))
                .catch(e => log(`L·ªói View: ${e.message}`, 'error'));
        };

        const simulateLike = (movie) => {
            // TƒÉng t·ª∑ l·ªá like l√™n 98% (G·∫ßn nh∆∞ lu√¥n like)
            if (Math.random() < 0.98) { 
                const movieDocRef = doc(db, dataCollectionPath, movie.id);
                updateDoc(movieDocRef, { likeCount: increment(1) })
                    .then(() => log(`[LIKE] ƒê√£ b√£o like cho: "${movie.title}"`, 'success'))
                    .catch(e => log(`L·ªói Like: ${e.message}`, 'error'));
            }
        };
        
        const simulateComment = (movie, user) => {
             // KH√îNG C√ÄY COMMENT CHO PHIM S·∫ÆP CHI·∫æU
            if (movie.status === 'sap-chieu') return;

            if (!user || !user.uid || Math.random() < 0.5) return; // 50% chance to comment
            
            const commentsColRef = collection(db, dataCollectionPath, movie.id, 'comments');
            // S·ª¨ D·ª§NG LOGIC COMMENT THEO NG·ªÆ C·∫¢NH
            const content = getCommentContentByGenre(movie); 
            const botName = getBotDisplayName();
            const botAvatar = getBotAvatar(botName); // Pass name as seed for consistency if needed
            
            addDoc(commentsColRef, {
                content: content,
                userId: user.uid,
                email: user.email,
                displayName: botName, 
                photoURL: botAvatar, 
                createdAt: serverTimestamp()
            }).then(() => {
                 const imgTag = `<img src="${botAvatar}" class="w-5 h-5 rounded-full inline mr-1" onerror="this.src='https://placehold.co/20x20/6B7280/ffffff?text=U'">`;
                 log(`[COMMENT] ${imgTag} <b>${botName}</b>: "${content}"`, 'success');
            }).catch(e => log(`L·ªói Comment: ${e.message}`, 'error'));
        };

        const simulateReply = async (movie, user) => {
            // KH√îNG C√ÄY REPLY CHO PHIM S·∫ÆP CHI·∫æU
            if (movie.status === 'sap-chieu') return false; 
            
            if (!user || !user.uid) return false;
            const lastComment = await fetchLastComment(movie.id);

            // 30% c∆° h·ªôi tr·∫£ l·ªùi n·∫øu comment cu·ªëi l√† c·ªßa ng∆∞·ªùi kh√°c v√† comment ƒë√≥ m·ªõi
            if (lastComment && lastComment.displayName !== getBotDisplayName() && Math.random() < 0.3) {
                const commentsColRef = collection(db, dataCollectionPath, movie.id, 'comments');
                const content = getRandomReplyContent(movie.title, lastComment);
                const botName = getBotDisplayName();
                const botAvatar = getBotAvatar(botName);

                addDoc(commentsColRef, {
                    content: content,
                    userId: user.uid,
                    email: user.email,
                    displayName: botName,
                    photoURL: botAvatar,
                    createdAt: serverTimestamp(),
                    replyTo: lastComment.id // Th√™m ID comment cha
                }).then(() => {
                    const imgTag = `<img src="${botAvatar}" class="w-5 h-5 rounded-full inline mr-1" onerror="this.src='https://placehold.co/20x20/6B7280/ffffff?text=U'">`;
                    log(`[REPLY] ${imgTag} <b>${botName}</b> @${lastComment.displayName}: "${content}"`, 'success');
                }).catch(e => log(`L·ªói Reply: ${e.message}`, 'error'));
                return true;
            }
            return false;
        };

        const simulateReview = (movie, user) => {
            if (!user || !user.uid || Math.random() < 0.5) return; 
            
            let rating;
            let content;

            if (movie.status === 'sap-chieu') {
                // Phim s·∫Øp chi·∫øu: Ch·ªâ ƒë√°nh gi√° 4 ho·∫∑c 5 sao (Hype)
                rating = Math.random() < 0.5 ? 5 : 4; 
                content = getRandomReviewContentAiring(movie.title);
            } else {
                 // Phim ƒë√£/ƒëang chi·∫øu: Logic ch·∫•m ƒëi·ªÉm 2-5 sao
                const rand = Math.random();
                if (rand < 0.5) rating = 5;
                else if (rand < 0.8) rating = 4;
                else if (rand < 0.9) rating = 3;
                else rating = 2;
                // S·ª¨ D·ª§NG LOGIC REVIEW THEO TH·ªÇ LO·∫†I & ƒêI·ªÇM S·ªê
                content = getReviewContentByGenre(movie, rating);
            }

            const reviewDocRef = doc(db, dataCollectionPath, movie.id, 'reviews', user.uid);
            const movieDocRef = doc(db, dataCollectionPath, movie.id);
            const botName = getBotDisplayName();
            const botAvatar = getBotAvatar(botName);

            // X√≥a logic update reviewTotal/reviewCount c≈© v√¨ g√¢y l·ªói tƒÉng ƒëi·ªÉm li√™n t·ª•c
            // Hi·ªán t·∫°i Bot ch·ªâ set Review m·ªõi, kh√¥ng t√≠nh to√°n ƒëi·ªÉm c≈© (ch·∫•p nh·∫≠n tƒÉng t·ªïng ƒëi·ªÉm)

            const batch = writeBatch(db);
            
            batch.set(reviewDocRef, {
                userId: user.uid,
                rating: rating,
                content: content,
                displayName: botName,
                photoURL: botAvatar, 
                updatedAt: serverTimestamp()
            }, { merge: true });

            batch.update(movieDocRef, {
                reviewTotal: increment(rating),
                reviewCount: increment(1) 
            }, { merge: true }); 
            
            batch.commit()
                .then(() => {
                     const imgTag = `<img src="${botAvatar}" class="w-5 h-5 rounded-full inline mr-1" onerror="this.src='https://placehold.co/20x20/6B7280/ffffff?text=U'">`;
                     log(`[REVIEW] ${imgTag} <b>${botName}</b> ƒë√°nh gi√° ${rating}‚≠ê: "${content}"`, 'success');
                }).catch(e => log(`L·ªói Review: ${e.message}`, 'error'));
        };

        // === LOGIC CH·∫†Y BOT ===
        const botLoop = async () => { 
             if (!isBotRunning || globalMovieCache.length === 0) { stopBotActivity(); return; }
            const randomMovie = globalMovieCache[Math.floor(Math.random() * globalMovieCache.length)];
            
            if (randomMovie.status === 'sap-chieu') {
                simulateLike(randomMovie);
                if (auth.currentUser && isGoogleAuth(auth.currentUser)) {
                    simulateReview(randomMovie, auth.currentUser);
                }
                return;
            }
            
            simulateView(randomMovie); 
            simulateLike(randomMovie);
            
            if (auth.currentUser && isGoogleAuth(auth.currentUser)) {
                const replied = await simulateReply(randomMovie, auth.currentUser);
                if (replied) return;
                simulateComment(randomMovie, auth.currentUser);
                simulateReview(randomMovie, auth.currentUser);
            } else {
                 log("Bot c·∫ßn ƒëƒÉng nh·∫≠p Google ƒë·ªÉ Comment/Review.", 'info');
            }
        };

        const startBotActivity = () => {
            if (isBotRunning || globalMovieCache.length === 0) {
                 log(globalMovieCache.length === 0 ? "Ch∆∞a t·∫£i d·ªØ li·ªáu phim..." : "Bot ƒëang ch·∫°y.", 'error');
                 return;
            }
            if (!auth.currentUser) {
                 log("C·∫ßn ƒëƒÉng nh·∫≠p Google ƒë·ªÉ ch·∫°y full t√≠nh nƒÉng.", 'error');
                 return;
            }
            isBotRunning = true;
            const btn = getEl('#bot-control-btn');
            const status = getEl('#bot-status-display');
            btn.textContent = 'ƒêANG C√ÄY VIEW/COMMENT... (D·ª´ng)';
            btn.classList.replace('bg-lime-500', 'bg-red-500');
            btn.classList.replace('hover:bg-lime-600', 'hover:bg-red-600');
            status.textContent = 'ƒêANG CH·∫†Y üöÄ';
            status.classList.replace('text-lime-400', 'text-red-400');
            botInterval = setInterval(botLoop, BOT_INTERVAL_MS);
            log(`üöÄ Bot ƒë√£ k√≠ch ho·∫°t! T·ªëc ƒë·ªô: ${BOT_INTERVAL_MS/1000}s/l·∫ßn.`, 'success');
            botLoop();
        };

        const stopBotActivity = () => {
            if (!isBotRunning) return;
            clearInterval(botInterval);
            isBotRunning = false;
            const btn = getEl('#bot-control-btn');
            const status = getEl('#bot-status-display');
            btn.textContent = 'B·∫ÆT ƒê·∫¶U C√ÄY';
            btn.classList.replace('bg-red-500', 'bg-lime-500');
            btn.classList.replace('hover:bg-red-600', 'hover:bg-lime-600');
            status.textContent = 'ƒê√É D·ª™NG üõë';
            status.classList.replace('text-red-400', 'text-lime-400');
            log("üõë Bot ƒë√£ d·ª´ng ho·∫°t ƒë·ªông.", 'info');
        };

        const handleBotToggle = () => {
            if (isBotRunning) { stopBotActivity(); } else { startBotActivity(); }
        };

        const handleGoogleLogin = async () => {
            try {
                await setPersistence(auth, browserLocalPersistence);
                await signInWithPopup(auth, new GoogleAuthProvider()); 
                log("ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng! ‚úÖ", 'success');
            } catch (error) { log(`L·ªói Login: ${error.message}`, 'error'); }
        };

        const handleLogout = () => { signOut(auth).then(() => log("ƒê√£ ƒëƒÉng xu·∫•t.", 'info')); };
        
        const loadInitialMovieCache = () => {
             if (!db) return;
             log("ƒêang t·∫£i kho phim...", 'info');
             const q = query(collection(db, dataCollectionPath), orderBy('title'), limit(100)); 
             getDocs(q).then(snapshot => {
                    globalMovieCache = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    log(`‚úÖ ƒê√£ t·∫£i xong ${globalMovieCache.length} phim. S·∫µn s√†ng!`, 'success');
             }).catch(e => log(`L·ªói t·∫£i phim: ${e.message}`, 'error'));
        };

        const setupFirebase = async () => {
            try {
                app = initializeApp(finalConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                await setPersistence(auth, browserLocalPersistence);
                if (initialAuthToken) await signInWithCustomToken(auth, initialAuthToken).catch(e => console.log(e));
                onAuthStateChanged(auth, (user) => {
                    userId = user ? user.uid : null;
                    updateAuthUI(user);
                    if (!isAuthInitialised) { isAuthInitialised = true; loadInitialMovieCache(); }
                });
                if (!auth.currentUser) signInAnonymously(auth).catch(e => console.log(e));
            } catch (error) { log(`L·ªói setup: ${error.message}`, 'error'); }
        };

        const updateAuthUI = (user) => {
            const authContainer = getEl('#auth-control');
            if (!authContainer) return;
            if (user && isGoogleAuth(user)) {
                const displayName = user.displayName || user.email;
                authContainer.innerHTML = `
                    <div class="flex items-center justify-between bg-gray-700 p-3 rounded-lg">
                        <span class="text-lime-400 font-bold">üë§ ${displayName}</span>
                        <button id="logout-btn" class="text-red-300 hover:text-red-100 text-xs underline">ƒêƒÉng Xu·∫•t</button>
                    </div>`;
                getEl('#logout-btn')?.addEventListener('click', handleLogout);
                getEl('#bot-control-btn').disabled = false;
                getEl('#bot-control-btn').classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                authContainer.innerHTML = `
                    <div class="flex items-center justify-between bg-gray-700 p-3 rounded-lg">
                        <span class="text-gray-400 text-sm">Ch∆∞a c√≥ quy·ªÅn Comment/Review</span>
                        <button id="google-login-btn" class="bg-white text-gray-900 font-bold py-1 px-3 rounded text-xs hover:bg-gray-200">Login Google</button>
                    </div>`;
                getEl('#google-login-btn')?.addEventListener('click', handleGoogleLogin);
            }
        };
        
        document.addEventListener('DOMContentLoaded', setupFirebase);
        document.addEventListener('DOMContentLoaded', () => { getEl('#bot-control-btn')?.addEventListener('click', handleBotToggle); });
    </script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-4 md:p-8 font-sans">
    <div class="max-w-3xl mx-auto">
        <header class="mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-lime-400 to-green-600">FOXANIME BOT TOOL ü§ñ</h1>
            <p class="text-gray-500 text-sm mt-2">H·ªá th·ªëng "C√†y View" & "Seeding" T·ª± ƒê·ªông H√≥a</p>
        </header>

        <!-- Auth Section -->
        <div id="auth-control" class="mb-6">Loading Auth...</div>

        <!-- Main Control -->
        <section class="bg-gray-800 rounded-xl shadow-2xl overflow-hidden border border-gray-700">
            <div class="p-6 flex flex-col items-center justify-center">
                <div class="mb-4 text-center">
                    <p class="text-gray-400 text-sm uppercase tracking-wider mb-1">TR·∫†NG TH√ÅI</p>
                    <p id="bot-status-display" class="text-3xl font-black text-lime-400">S·∫¥N S√ÄNG</p>
                </div>
                
                <button id="bot-control-btn" 
                    class="w-full md:w-auto bg-lime-500 hover:bg-lime-600 text-gray-900 font-bold py-4 px-12 rounded-full text-xl shadow-lg transform transition hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
                    disabled>
                    B·∫ÆT ƒê·∫¶U C√ÄY
                </button>
                
                <p class="text-gray-500 text-xs mt-4 text-center px-4">
                    ‚ö†Ô∏è Bot s·∫Ω ho·∫°t ƒë·ªông li√™n t·ª•c m·ªói 5 gi√¢y. <br> Vui l√≤ng gi·ªØ tab n√†y m·ªü ƒë·ªÉ Bot ho·∫°t ƒë·ªông.
                </p>
            </div>
            
            <!-- Logs Terminal -->
            <div class="bg-black p-4 border-t border-gray-700">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xs text-gray-500 font-mono">TERMINAL LOGS</span>
                    <span class="flex h-2 w-2 relative">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-lime-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-lime-500"></span>
                    </span>
                </div>
                <div id="bot-logs" class="h-64 overflow-y-auto font-mono text-xs text-gray-300 space-y-1 scrollbar-hide">
                    <div class="text-gray-600 italic"> > Ch·ªù l·ªánh kh·ªüi ƒë·ªông...</div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>