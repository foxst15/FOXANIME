<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FB API Commander - B√© L√¥i Tool v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
        body { font-family: 'Segoe UI', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .log-entry { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        .tab-active { border-bottom: 2px solid #3b82f6; color: #60a5fa; }
        .tab-inactive { color: #94a3b8; }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 p-4 flex justify-between items-center shadow-lg z-10">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center shadow-blue-500/50 shadow-lg">
                <i class="fa-brands fa-facebook-f text-white text-xl"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-white tracking-wide">FB API COMMANDER <span class="text-xs bg-red-500 text-white px-1 rounded ml-1">v2.0 PRO</span></h1>
                <p class="text-xs text-slate-400">Coded by B√© L√¥i ‚Ä¢ Graph API v18.0</p>
            </div>
        </div>
        <div class="flex items-center gap-2">
            <span class="px-3 py-1 bg-yellow-500/10 text-yellow-500 border border-yellow-500/20 rounded-full text-xs font-mono">
                <i class="fa-solid fa-robot mr-1"></i> Bot Mode Active
            </span>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Left Panel: Controls -->
        <div class="w-full md:w-1/3 lg:w-1/4 bg-slate-800/50 border-r border-slate-700 flex flex-col overflow-hidden">
            
            <div class="p-6 pb-2 overflow-y-auto custom-scrollbar flex-1 space-y-6">
                <!-- Token Configuration -->
                <div class="space-y-3">
                    <h2 class="text-sm font-bold text-blue-400 uppercase tracking-wider border-b border-slate-700 pb-2">
                        <i class="fa-solid fa-key mr-2"></i>C·∫•u H√¨nh (Config)
                    </h2>
                    <div>
                        <label class="block text-xs text-slate-400 mb-1">Access Token (Required)</label>
                        <div class="relative">
                            <input type="password" id="accessToken" placeholder="Nh·∫≠p Token EAA..." 
                                class="w-full bg-slate-900 border border-slate-600 rounded p-2.5 text-sm text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition font-mono">
                            <button onclick="toggleTokenVisibility()" class="absolute right-3 top-2.5 text-slate-500 hover:text-white transition">
                                <i class="fa-solid fa-eye" id="eyeIcon"></i>
                            </button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs text-slate-400 mb-1">Target ID (Post/Photo ID)</label>
                        <input type="text" id="targetId" placeholder="VD: 123456789..." 
                            class="w-full bg-slate-900 border border-slate-600 rounded p-2.5 text-sm text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition font-mono">
                    </div>
                    <button onclick="checkObjectInfo()" class="w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded text-sm font-medium transition flex items-center justify-center gap-2">
                        <i class="fa-solid fa-magnifying-glass"></i> Ki·ªÉm tra Info ID
                    </button>
                </div>

                <!-- Actions Tab -->
                <div class="space-y-3">
                    <h2 class="text-sm font-bold text-green-400 uppercase tracking-wider border-b border-slate-700 pb-2">
                        <i class="fa-solid fa-bolt mr-2"></i>Ch·ª©c NƒÉng
                    </h2>
                    
                    <!-- Tab Headers -->
                    <div class="flex border-b border-slate-700 mb-3">
                        <button onclick="switchTab('manual')" id="tab-manual" class="flex-1 pb-2 text-sm font-bold tab-active transition">Th·ªß C√¥ng</button>
                        <button onclick="switchTab('auto')" id="tab-auto" class="flex-1 pb-2 text-sm font-bold tab-inactive transition">Auto Bot ü§ñ</button>
                    </div>

                    <!-- Manual Content -->
                    <div id="content-manual" class="space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="sendReaction('LIKE')" class="bg-blue-600 hover:bg-blue-500 text-white p-3 rounded shadow-lg shadow-blue-900/20 active:scale-95 transition flex flex-col items-center gap-1">
                                <i class="fa-solid fa-thumbs-up text-xl"></i>
                                <span class="text-xs font-bold">LIKE</span>
                            </button>
                            <button onclick="sendReaction('LOVE')" class="bg-pink-600 hover:bg-pink-500 text-white p-3 rounded shadow-lg shadow-pink-900/20 active:scale-95 transition flex flex-col items-center gap-1">
                                <i class="fa-solid fa-heart text-xl"></i>
                                <span class="text-xs font-bold">LOVE</span>
                            </button>
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">Comment Th·ªß c√¥ng</label>
                            <div class="flex gap-2">
                                <input id="manualCommentMsg" type="text" placeholder="Nh·∫≠p b√¨nh lu·∫≠n..." 
                                    class="flex-1 bg-slate-900 border border-slate-600 rounded p-2 text-sm text-white focus:border-blue-500 outline-none">
                                <button onclick="sendComment(document.getElementById('manualCommentMsg').value)" class="bg-emerald-600 hover:bg-emerald-500 text-white px-4 rounded shadow-lg">
                                    <i class="fa-solid fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Auto Content -->
                    <div id="content-auto" class="space-y-3 hidden">
                        <div>
                            <label class="block text-xs text-slate-400 mb-1 flex justify-between">
                                <span>Danh s√°ch Comment (M·ªói d√≤ng 1 c√°i)</span>
                                <span class="text-blue-400 cursor-pointer" onclick="fillSampleComments()">[M·∫´u]</span>
                            </label>
                            <textarea id="autoCommentList" rows="5" placeholder="Tuy·ªát v·ªùi qu√° shop ∆°i&#10;Inbox m√¨nh nh√©&#10;T∆∞ v·∫•n gi√∫p em v·ªõi..." 
                                class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-sm text-white focus:border-blue-500 outline-none resize-none font-mono"></textarea>
                        </div>
                        
                        <div class="flex items-center gap-2">
                             <div class="flex-1">
                                <label class="block text-[10px] text-slate-400 mb-1">Delay (Gi√¢y)</label>
                                <input type="number" id="autoDelay" value="5" min="2"
                                    class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-center text-sm font-bold">
                            </div>
                            <div class="flex-[2] pt-4">
                                <button id="btnStartAuto" onclick="toggleAutoComment()" class="w-full bg-purple-600 hover:bg-purple-500 text-white py-2 rounded text-sm font-bold transition shadow-lg shadow-purple-900/20 flex items-center justify-center gap-2">
                                    <i class="fa-solid fa-play"></i> CH·∫†Y AUTO
                                </button>
                            </div>
                        </div>
                        <p class="text-[10px] text-yellow-500/80 italic mt-1">
                            <i class="fa-solid fa-triangle-exclamation"></i> C·∫£nh b√°o: ƒê·ª´ng ƒë·ªÉ delay qu√° th·∫•p k·∫ªo b·ªã Checkpoint nha Ch·ªß nh√¢n!
                        </p>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="p-4 border-t border-slate-700 bg-slate-800/30 text-center">
                <p class="text-[10px] text-slate-600">
                    B√© L√¥i Bot v2.0 - Automation Tool
                </p>
            </div>
        </div>

        <!-- Right Panel: Logs -->
        <div class="flex-1 bg-slate-950 flex flex-col min-w-0">
            <div class="bg-slate-900 p-2 border-b border-slate-800 flex justify-between items-center px-4">
                <span class="text-xs font-mono text-slate-400 flex items-center gap-2">
                    <i class="fa-solid fa-terminal"></i> SYSTEM_LOGS
                </span>
                <div class="flex gap-2">
                    <span id="statusIndicator" class="text-xs font-bold text-slate-500 flex items-center gap-1 hidden">
                         <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> RUNNING...
                    </span>
                    <button onclick="clearLogs()" class="text-xs text-red-400 hover:text-red-300 transition ml-2">
                        <i class="fa-solid fa-trash"></i> Clear
                    </button>
                </div>
            </div>
            
            <!-- Terminal Output -->
            <div id="logContainer" class="flex-1 p-4 overflow-y-auto font-mono text-sm space-y-2 select-text">
                <div class="text-slate-500 italic">--- Waiting for command... ---</div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-5 right-5 bg-slate-800 border border-slate-600 text-white px-4 py-3 rounded shadow-2xl transform translate-y-20 opacity-0 transition duration-300 flex items-center gap-3 z-50">
        <i id="toastIcon" class="fa-solid fa-circle-check text-green-500"></i>
        <span id="toastMsg" class="text-sm font-medium">Notification</span>
    </div>

    <script>
        // --- Constants & Setup ---
        const API_VERSION = 'v18.0';
        const logContainer = document.getElementById('logContainer');
        let isAutoRunning = false;
        let autoInterval = null;

        // --- Helper Functions ---
        function addLog(type, message, details = '') {
            const time = new Date().toLocaleTimeString('vi-VN');
            const color = type === 'SUCCESS' ? 'text-green-400' : (type === 'ERROR' ? 'text-red-400' : (type === 'BOT' ? 'text-purple-400' : 'text-blue-400'));
            const icon = type === 'SUCCESS' ? '‚úì' : (type === 'ERROR' ? '‚úó' : (type === 'BOT' ? 'ü§ñ' : '‚Ñπ'));
            
            const div = document.createElement('div');
            div.className = 'log-entry break-words border-l-2 pl-2 border-slate-700 hover:bg-slate-900/50 p-1 rounded';
            div.innerHTML = `
                <span class="text-slate-600 text-xs">[${time}]</span>
                <span class="${color} font-bold">[${type}]</span> 
                <span class="text-slate-200">${message}</span>
                ${details ? `<div class="text-xs text-slate-500 mt-1 ml-4">${details}</div>` : ''}
            `;
            
            logContainer.appendChild(div);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function showToast(type, msg) {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toastIcon');
            const text = document.getElementById('toastMsg');
            
            text.innerText = msg;
            icon.className = type === 'success' ? 'fa-solid fa-circle-check text-green-500' : 'fa-solid fa-circle-xmark text-red-500';
            
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        function clearLogs() {
            logContainer.innerHTML = '<div class="text-slate-500 italic">--- Logs cleared ---</div>';
        }

        function toggleTokenVisibility() {
            const input = document.getElementById('accessToken');
            const icon = document.getElementById('eyeIcon');
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fa-solid fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fa-solid fa-eye';
            }
        }

        function switchTab(tab) {
            const manualBtn = document.getElementById('tab-manual');
            const autoBtn = document.getElementById('tab-auto');
            const manualContent = document.getElementById('content-manual');
            const autoContent = document.getElementById('content-auto');

            if (tab === 'manual') {
                manualBtn.className = 'flex-1 pb-2 text-sm font-bold tab-active transition';
                autoBtn.className = 'flex-1 pb-2 text-sm font-bold tab-inactive transition';
                manualContent.classList.remove('hidden');
                autoContent.classList.add('hidden');
            } else {
                manualBtn.className = 'flex-1 pb-2 text-sm font-bold tab-inactive transition';
                autoBtn.className = 'flex-1 pb-2 text-sm font-bold tab-active transition';
                manualContent.classList.add('hidden');
                autoContent.classList.remove('hidden');
            }
        }

        function fillSampleComments() {
            const comments = [
                "B√†i vi·∫øt tuy·ªát v·ªùi qu√°! ‚ù§Ô∏è",
                "Inbox m√¨nh t∆∞ v·∫•n th√™m nh√© shop ∆°i",
                "H√†ng ƒë·∫πp qu√°, cho m√¨nh xin gi√° ·∫°",
                "ƒê√£ th·∫£ tim cho b·∫°n n√® üëç",
                "Uy t√≠n qu√°, ch√∫c shop ƒë·∫Øt h√†ng",
                "Check ib m√¨nh v·ªõi nha",
                "S·∫£n ph·∫©m n√†y c√≤n kh√¥ng ·∫°?",
                "Quan t√¢m ·∫°!"
            ];
            document.getElementById('autoCommentList').value = comments.join('\n');
        }

        function getInputs() {
            const token = document.getElementById('accessToken').value.trim();
            const id = document.getElementById('targetId').value.trim();
            if (!token) {
                addLog('ERROR', 'Thi·∫øu Access Token', 'Vui l√≤ng nh·∫≠p Token tr∆∞·ªõc khi ch·∫°y.');
                showToast('error', 'Ch∆∞a nh·∫≠p Token!');
                return null;
            }
            if (!id) {
                addLog('ERROR', 'Thi·∫øu Target ID', 'Vui l√≤ng nh·∫≠p ID b√†i vi·∫øt/·∫£nh.');
                showToast('error', 'Ch∆∞a nh·∫≠p ID!');
                return null;
            }
            return { token, id };
        }

        // --- API Functions ---

        async function checkObjectInfo() {
            const data = getInputs();
            if (!data) return;

            addLog('INFO', `ƒêang ki·ªÉm tra ID: ${data.id}...`);
            
            try {
                const response = await fetch(`https://graph.facebook.com/${API_VERSION}/${data.id}?fields=id,message,created_time,from&access_token=${data.token}`);
                const result = await response.json();

                if (result.error) {
                    throw new Error(result.error.message);
                }

                addLog('SUCCESS', 'ƒê√£ t√¨m th·∫•y b√†i vi·∫øt!', `
                    Author: ${result.from ? result.from.name : 'Unknown'}<br>
                    Time: ${result.created_time}<br>
                    Content: ${(result.message || 'No text content').substring(0, 50)}...
                `);
                showToast('success', 'ID h·ª£p l·ªá!');
            } catch (err) {
                addLog('ERROR', 'Kh√¥ng th·ªÉ l·∫•y th√¥ng tin', err.message);
                showToast('error', 'L·ªói ki·ªÉm tra ID');
            }
        }

        async function sendReaction(type) {
            const data = getInputs();
            if (!data) return;

            let url = `https://graph.facebook.com/${API_VERSION}/${data.id}/likes`;
            addLog('INFO', `ƒêang th·∫£ ${type}...`);

            try {
                const response = await fetch(`${url}?access_token=${data.token}`, { method: 'POST' });
                const result = await response.json();

                if (result.error) throw new Error(result.error.message);
                addLog('SUCCESS', `ƒê√£ th·∫£ ${type} th√†nh c√¥ng!`);
                showToast('success', `ƒê√£ ${type} th√†nh c√¥ng!`);
            } catch (err) {
                addLog('ERROR', 'L·ªói th·∫£ c·∫£m x√∫c', err.message);
            }
        }

        async function sendComment(message) {
            const data = getInputs();
            if (!data) return false;

            if (!message || message.trim() === "") {
                addLog('ERROR', 'N·ªôi dung tr·ªëng', 'Kh√¥ng c√≥ n·ªôi dung ƒë·ªÉ comment.');
                return false;
            }

            // addLog('INFO', `ƒêang g·ª≠i comment...`, `Msg: "${message}"`); // Reduce spam logs if auto

            try {
                const formData = new FormData();
                formData.append('message', message);
                formData.append('access_token', data.token);

                const response = await fetch(`https://graph.facebook.com/${API_VERSION}/${data.id}/comments`, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();

                if (result.error) throw new Error(result.error.message);

                addLog('SUCCESS', 'ƒê√£ g·ª≠i comment!', `Msg: "${message}" <br>ID: ${result.id}`);
                return true;
            } catch (err) {
                addLog('ERROR', 'L·ªói Comment', `${err.message} <br>(Msg: ${message})`);
                return false;
            }
        }

        // --- Auto Logic ---

        function toggleAutoComment() {
            if (isAutoRunning) {
                stopAuto();
            } else {
                startAuto();
            }
        }

        function startAuto() {
            const data = getInputs();
            if (!data) return;

            const listText = document.getElementById('autoCommentList').value.trim();
            if (!listText) {
                addLog('ERROR', 'Ch∆∞a nh·∫≠p n·ªôi dung', 'Vui l√≤ng nh·∫≠p danh s√°ch comment v√†o √¥ Auto.');
                showToast('error', 'Nh·∫≠p list comment ƒëi ·∫°!');
                return;
            }

            const comments = listText.split('\n').filter(line => line.trim() !== '');
            if (comments.length === 0) return;

            const delaySec = parseInt(document.getElementById('autoDelay').value) || 5;
            
            isAutoRunning = true;
            document.getElementById('btnStartAuto').innerHTML = '<i class="fa-solid fa-stop"></i> D·ª™NG AUTO';
            document.getElementById('btnStartAuto').className = 'w-full bg-red-600 hover:bg-red-500 text-white py-2 rounded text-sm font-bold transition shadow-lg shadow-red-900/20 flex items-center justify-center gap-2 animate-pulse';
            document.getElementById('statusIndicator').classList.remove('hidden');

            addLog('BOT', 'ü§ñ AUTO BOT ƒê√É KH·ªûI ƒê·ªòNG', `S·ªë l∆∞·ª£ng m·∫´u: ${comments.length} c√¢u. Delay: ${delaySec}s`);

            let index = 0;
            
            // Run immediately first time
            processAutoStep(comments);

            autoInterval = setInterval(() => {
                if (!isAutoRunning) return;
                processAutoStep(comments);
            }, delaySec * 1000);
        }

        function processAutoStep(comments) {
            // Pick Random Comment
            const randomMsg = comments[Math.floor(Math.random() * comments.length)];
            // Add unique ID to avoid duplicate content filter by FB
            const uniqueMsg = `${randomMsg} (${Math.floor(Math.random() * 1000)})`;
            
            addLog('BOT', 'ƒêang th·ª±c thi t√°c v·ª•...', `Chu·∫©n b·ªã g·ª≠i: "${uniqueMsg}"`);
            
            sendComment(uniqueMsg);
        }

        function stopAuto() {
            isAutoRunning = false;
            clearInterval(autoInterval);
            document.getElementById('btnStartAuto').innerHTML = '<i class="fa-solid fa-play"></i> CH·∫†Y AUTO';
            document.getElementById('btnStartAuto').className = 'w-full bg-purple-600 hover:bg-purple-500 text-white py-2 rounded text-sm font-bold transition shadow-lg shadow-purple-900/20 flex items-center justify-center gap-2';
            document.getElementById('statusIndicator').classList.add('hidden');
            addLog('BOT', 'üõë ƒê√É D·ª™NG AUTO BOT', 'Theo y√™u c·∫ßu c·ªßa Ch·ªß nh√¢n.');
        }
    </script>
</body>
</html>